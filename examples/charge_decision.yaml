conn_string: dbname=sensor
relay_url: http://10.88.99.100
full_charge_after: 7 days
respect_manual: true
debug: true
sql:
  prepare:
    PREPARE info AS INSERT INTO event (name,value) VALUES ('charger', $1);
    PREPARE full_charge_needed AS SELECT ($1 < current_timestamp-ts) FROM event WHERE name='victron' AND (value->>'name')='Akkumittari' AND (value->'payload'->>'soc')::numeric=100 ORDER BY ts DESC LIMIT 1;
    PREPARE soc AS SELECT (value->'payload'->'soc')::numeric FROM event WHERE name='victron' AND (value->>'name')='Akkumittari' AND ts > current_timestamp - interval '5 min' ORDER BY ts DESC LIMIT 1;
    PREPARE profile AS SELECT 'default', 20, 80, true;
  decision: INSERT INTO decisions (decision) VALUES(?);
